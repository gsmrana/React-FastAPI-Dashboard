{% extends "base.html" %}

{% block title %}Services - Mediahub{% endblock %}

{% block navbar %}
    {% include "navbar.html" %}
{% endblock %}

{% block sidebar %}
    {% include "sidebar.html" %}
{% endblock %}

{% block content %}
<div class="container-fluid py-4">
    <!-- Alert Container -->
    <div id="alertContainer"></div>
    
    <!-- Page Header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h2 class="mb-1"><i class="fas fa-server me-2"></i>Services</h2>
            <p class="text-muted mb-0">Manage your service credentials and accounts</p>
        </div>
        <button class="btn btn-primary" id="addNewBtn">
            <i class="fas fa-plus me-2"></i>Add Service
        </button>
    </div>

    <!-- Data Table Card -->
    <div class="card shadow-sm">
        <div class="card-body">
            <table id="dataTable" class="table table-hover" style="width:100%">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>URL</th>
                        <th>Username</th>
                        <th>Category</th>
                        <th>Starred</th>
                        <th>Tags</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>
</div>

<!-- Add/Edit Service Modal -->
<div class="modal fade" id="serviceModal" tabindex="-1" aria-labelledby="modalTitle" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalTitle">Add New Service</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="serviceForm">
                    <input type="hidden" id="serviceId">
                    
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="serviceName" class="form-label">Service Name <span class="text-danger">*</span></label>
                            <input type="text" class="form-control" id="serviceName" required placeholder="e.g., GitHub, Gmail">
                        </div>
                        <div class="col-md-6">
                            <label for="serviceUrl" class="form-label">URL <span class="text-danger">*</span></label>
                            <input type="url" class="form-control" id="serviceUrl" required placeholder="https://example.com">
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="serviceUsername" class="form-label">Username / Email</label>
                            <input type="text" class="form-control" id="serviceUsername" placeholder="Enter username or email">
                        </div>
                        <div class="col-md-6">
                            <label for="servicePassword" class="form-label">Password</label>
                            <div class="input-group">
                                <input type="password" class="form-control" id="servicePassword" placeholder="Enter password">
                                <button class="btn btn-outline-secondary" type="button" id="togglePassword">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="btn btn-outline-secondary" type="button" id="copyPassword" title="Copy password">
                                    <i class="fas fa-copy"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="serviceCategory" class="form-label">Category</label>
                            <select class="form-select" id="serviceCategory">
                                <option value="0">Social Media</option>
                                <option value="1">Email</option>
                                <option value="2">Banking & Finance</option>
                                <option value="3">Shopping</option>
                                <option value="4">Entertainment</option>
                                <option value="5">Development</option>
                                <option value="6">Cloud Services</option>
                                <option value="7">Work</option>
                                <option value="8">Other</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label for="serviceStarred" class="form-label">Starred</label>
                            <select class="form-select" id="serviceStarred">
                                <option value="false">No</option>
                                <option value="true">Yes</option>
                            </select>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="serviceTags" class="form-label">Tags</label>
                        <input type="text" class="form-control" id="serviceTags" placeholder="Comma-separated tags (e.g., work, personal, important)">
                    </div>

                    <div class="mb-3">
                        <label for="serviceNotes" class="form-label">Notes</label>
                        <textarea class="form-control" id="serviceNotes" rows="3" placeholder="Additional notes or recovery information..."></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="closeBtn" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="saveBtn">
                    <i class="fas fa-save me-1"></i>Save
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Delete Confirmation Modal -->
<div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="deleteModalLabel">Confirm Delete</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete this service? This action cannot be undone.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-danger" id="confirmDeleteBtn">
                    <i class="fas fa-trash me-1"></i>Delete
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Loading Overlay -->
<div id="loadingOverlay" class="loading-overlay" style="display: none;">
    <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
    </div>
</div>
{% endblock %}

{% block script %}
<script src="/assets/js/services.js" type="module"></script>
{% endblock %}
