{% extends "base.html" %}

{% block title %}LLM Models - Mediahub{% endblock %}

{% block navbar %}
    {% include "navbar.html" %}
{% endblock %}

{% block sidebar %}
    {% include "sidebar.html" %}
{% endblock %}

{% block content %}
<div class="container-fluid py-4">
    <!-- Alert Container -->
    <div id="alertContainer"></div>
    
    <!-- Page Header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h2 class="mb-1"><i class="fas fa-brain me-2"></i>LLM Models</h2>
            <p class="text-muted mb-0">Manage your AI model configurations and API keys</p>
        </div>
        <button class="btn btn-outline-primary" id="addNewBtn">
            <i class="fas fa-plus me-2"></i>Add Model
        </button>
    </div>

    <!-- Data Table Card -->
    <div class="card shadow-sm">
        <div class="card-body">
            <div class="table-responsive">
                <table id="dataTable" class="table table-hover" style="width:100%">
                    <thead>
                        <tr>
                            <th>Title</th>
                            <th>Model Name</th>
                            <th>Provider</th>
                            <th>Category</th>
                            <th>Temperature</th>
                            <th>Active</th>
                            <th>Starred</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>

</div>

<!-- Add/Edit LLM Modal -->
<div class="modal fade" id="llmModal" tabindex="-1" aria-labelledby="modalTitle" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalTitle">Add New LLM Model</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="llmForm">
                    <input type="hidden" id="llmId">
                    
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="llmTitle" class="form-label">Title <span class="text-danger">*</span></label>
                            <input type="text" class="form-control" id="llmTitle" required placeholder="e.g., GPT-4 Production">
                        </div>
                        <div class="col-md-6">
                            <label for="llmModelName" class="form-label">Model Name <span class="text-danger">*</span></label>
                            <input type="text" class="form-control" id="llmModelName" required placeholder="e.g., gpt-4, claude-3-opus">
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="llmProvider" class="form-label">Provider <span class="text-danger">*</span></label>
                            <select class="form-select" id="llmProvider" required>
                                <option value="0">OpenAI</option>
                                <option value="1">Anthropic</option>
                                <option value="2">Azure OpenAI</option>
                                <option value="3">Google AI</option>
                                <option value="4">AWS Bedrock</option>
                                <option value="5">Cohere</option>
                                <option value="6">Mistral AI</option>
                                <option value="7">Hugging Face</option>
                                <option value="8">Local/Ollama</option>
                                <option value="9">Other</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label for="llmCategory" class="form-label">Category <span class="text-danger">*</span></label>
                            <select class="form-select" id="llmCategory" required>
                                <option value="0">LLM (Chat/Completion)</option>
                                <option value="1">Embeddings</option>
                                <option value="2">Image Generation</option>
                                <option value="3">Speech to Text</option>
                                <option value="4">Text to Speech</option>
                                <option value="5">Vision</option>
                                <option value="6">Code Generation</option>
                                <option value="7">Other</option>
                            </select>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-12">
                            <label for="llmApiEndpoint" class="form-label">API Endpoint <span class="text-danger">*</span></label>
                            <input type="url" class="form-control" id="llmApiEndpoint" required placeholder="https://api.openai.com/v1">
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-12">
                            <label for="llmApiKey" class="form-label">API Key <span class="text-danger">*</span></label>
                            <div class="input-group">
                                <input type="password" class="form-control" id="llmApiKey" required placeholder="sk-...">
                                <button class="btn btn-outline-secondary" type="button" id="toggleApiKey">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="btn btn-outline-secondary" type="button" id="copyApiKey" title="Copy API Key">
                                    <i class="fas fa-copy"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-4">
                            <label for="llmTemperature" class="form-label">Temperature</label>
                            <div class="input-group">
                                <input type="range" class="form-range mt-2" id="llmTemperatureRange" min="0" max="2" step="0.1" value="0.5">
                                <input type="number" class="form-control ms-2" id="llmTemperature" min="0" max="2" step="0.1" value="0.5" style="width: 80px;">
                            </div>
                        </div>
                        <div class="col-md-4">
                            <label for="llmActive" class="form-label">Active</label>
                            <select class="form-select" id="llmActive">
                                <option value="true">Yes</option>
                                <option value="false">No</option>
                            </select>
                        </div>
                        <div class="col-md-4">
                            <label for="llmStarred" class="form-label">Starred</label>
                            <select class="form-select" id="llmStarred">
                                <option value="false">No</option>
                                <option value="true">Yes</option>
                            </select>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="llmTags" class="form-label">Tags</label>
                        <input type="text" class="form-control" id="llmTags" placeholder="Comma-separated tags (e.g., production, testing, fast)">
                    </div>

                    <div class="mb-3">
                        <label for="llmNotes" class="form-label">Notes</label>
                        <textarea class="form-control" id="llmNotes" rows="3" placeholder="Additional notes about this model configuration..."></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline-info" id="testConnectionBtn">
                    <i class="fas fa-plug me-1"></i>Test Connection
                </button>
                <button type="button" class="btn btn-secondary" id="closeBtn" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="saveBtn">
                    <i class="fas fa-save me-1"></i>Save
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Delete Confirmation Modal -->
<div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="deleteModalLabel">Confirm Delete</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete this LLM model configuration? This action cannot be undone.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-danger" id="confirmDeleteBtn">
                    <i class="fas fa-trash me-1"></i>Delete
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Loading Overlay -->
<div id="loadingOverlay" class="loading-overlay" style="display: none;">
    <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
    </div>
</div>
{% endblock %}

{% block script %}
<script src="/assets/js/llm-manager.js" type="module"></script>
{% endblock %}
